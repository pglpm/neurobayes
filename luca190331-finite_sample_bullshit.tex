\pdfoutput=1
%% Author: PGL  Porta Mana
%% Created: 2019-03-25T15:02:24+0100
%% Last-Updated: 2019-04-02T17:19:17+0200
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newif\ifarxiv
\arxivfalse
\ifarxiv\pdfmapfile{+classico.map}\fi
\newif\ifafour
\afourfalse% true = A4, false = A5
\newif\iftypodisclaim % typographical disclaim on the side
\typodisclaimtrue
\newcommand*{\memfontfamily}{zplx}
\newcommand*{\memfontpack}{newpxtext}
\documentclass[\ifafour a4paper,12pt,\else a5paper,10pt,\fi%extrafontsizes,%
onecolumn,oneside,article,%french,italian,german,swedish,latin,
british%
]{memoir}
\newcommand*{\updated}{\today}
\newcommand*{\firstdraft}{31 March 2019}
\newcommand*{\firstpublished}{***}
\newcommand*{\propertitle}{A direct forecast for the mutual information\\of stimulus and response%\\{\large ***}%
}
\newcommand*{\pdftitle}{A direct forecast for the mutual information of stimulus and response}
\newcommand*{\headtitle}{Sampling non-bias}
\newcommand*{\pdfauthor}{P.G.L.  Porta Mana, C. Battistin, S. Gonzalo Cogno}
\newcommand*{\headauthor}{Porta Mana, Battistin, Gonzalo Cogno}
\newcommand*{\reporthead}{}% Report number

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Calls to packages (uncomment as needed)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\usepackage{pifont}

%\usepackage{fontawesome}

\usepackage[T1]{fontenc} 
\input{glyphtounicode} \pdfgentounicode=1

\usepackage[utf8]{inputenx}

%\usepackage{newunicodechar}
% \newunicodechar{Ĕ}{\u{E}}
% \newunicodechar{ĕ}{\u{e}}
% \newunicodechar{Ĭ}{\u{I}}
% \newunicodechar{ĭ}{\u{\i}}
% \newunicodechar{Ŏ}{\u{O}}
% \newunicodechar{ŏ}{\u{o}}
% \newunicodechar{Ŭ}{\u{U}}
% \newunicodechar{ŭ}{\u{u}}
% \newunicodechar{Ā}{\=A}
% \newunicodechar{ā}{\=a}
% \newunicodechar{Ē}{\=E}
% \newunicodechar{ē}{\=e}
% \newunicodechar{Ī}{\=I}
% \newunicodechar{ī}{\={\i}}
% \newunicodechar{Ō}{\=O}
% \newunicodechar{ō}{\=o}
% \newunicodechar{Ū}{\=U}
% \newunicodechar{ū}{\=u}
% \newunicodechar{Ȳ}{\=Y}
% \newunicodechar{ȳ}{\=y}

\newcommand*{\bmmax}{0} % reduce number of bold fonts, before font packages
\newcommand*{\hmmax}{0} % reduce number of heavy fonts, before font packages

\usepackage{textcomp}

%\usepackage[normalem]{ulem}% package for underlining
% \makeatletter
% \def\ssout{\bgroup \ULdepth=-.35ex%\UL@setULdepth
%  \markoverwith{\lower\ULdepth\hbox
%    {\kern-.03em\vbox{\hrule width.2em\kern1.2\p@\hrule}\kern-.03em}}%
%  \ULon}
% \makeatother

\usepackage{amsmath}

\usepackage{mathtools}
\addtolength{\jot}{\jot} % increase spacing in multiline formulae
\setlength{\multlinegap}{0pt}

%\usepackage{empheq}% automatically calls amsmath and mathtools
\newcommand*{\widefbox}[1]{\fbox{\hspace{1em}#1\hspace{1em}}}

%\usepackage{fancybox}

%\usepackage{framed}

% \usepackage[misc]{ifsym} % for dice
% \newcommand*{\diceone}{{\scriptsize\Cube{1}}}

\usepackage{amssymb}

\usepackage{amsxtra}

\usepackage[main=british,french,italian,german,swedish,latin,esperanto]{babel}\selectlanguage{british}
\newcommand*{\langfrench}{\foreignlanguage{french}}
\newcommand*{\langgerman}{\foreignlanguage{german}}
\newcommand*{\langitalian}{\foreignlanguage{italian}}
\newcommand*{\langswedish}{\foreignlanguage{swedish}}
\newcommand*{\langlatin}{\foreignlanguage{latin}}
\newcommand*{\langnohyph}{\foreignlanguage{nohyphenation}}

\usepackage[autostyle=false,autopunct=false,english=british]{csquotes}
\setquotestyle{british}

\usepackage{amsthm}
\newcommand*{\QED}{\textsc{q.e.d.}}
\renewcommand*{\qedsymbol}{\QED}
\theoremstyle{remark}
\newtheorem{note}{Note}
\newtheorem*{remark}{Note}
\newtheoremstyle{innote}{\parsep}{\parsep}{\footnotesize}{}{}{}{0pt}{}
\theoremstyle{innote}
\newtheorem*{innote}{}

\usepackage[shortlabels,inline]{enumitem}
\SetEnumitemKey{para}{itemindent=\parindent,leftmargin=0pt,listparindent=\parindent,parsep=0pt,itemsep=\topsep}
% \begin{asparaenum} = \begin{enumerate}[para]
% \begin{inparaenum} = \begin{enumerate*}
\setlist[enumerate,2]{label=\alph*.}
\setlist[enumerate]{label=\arabic*.,leftmargin=1.5\parindent}
\setlist[itemize]{leftmargin=1.5\parindent}
\setlist[description]{leftmargin=1.5\parindent}
% old alternative:
% \setlist[enumerate,2]{label=\alph*.}
% \setlist[enumerate]{leftmargin=\parindent}
% \setlist[itemize]{leftmargin=\parindent}
% \setlist[description]{leftmargin=\parindent}

\usepackage[babel,theoremfont,largesc]{newpxtext}

\usepackage[bigdelims,nosymbolsc%,smallerops % probably arXiv doesn't have it
]{newpxmath}
\useosf\linespread{1.083}
%% smaller operators for old version of newpxmath
\makeatletter
\def\re@DeclareMathSymbol#1#2#3#4{%
    \let#1=\undefined
    \DeclareMathSymbol{#1}{#2}{#3}{#4}}
%\re@DeclareMathSymbol{\bigsqcupop}{\mathop}{largesymbols}{"46}
%\re@DeclareMathSymbol{\bigodotop}{\mathop}{largesymbols}{"4A}
\re@DeclareMathSymbol{\bigoplusop}{\mathop}{largesymbols}{"4C}
\re@DeclareMathSymbol{\bigotimesop}{\mathop}{largesymbols}{"4E}
\re@DeclareMathSymbol{\sumop}{\mathop}{largesymbols}{"50}
\re@DeclareMathSymbol{\prodop}{\mathop}{largesymbols}{"51}
\re@DeclareMathSymbol{\bigcupop}{\mathop}{largesymbols}{"53}
\re@DeclareMathSymbol{\bigcapop}{\mathop}{largesymbols}{"54}
%\re@DeclareMathSymbol{\biguplusop}{\mathop}{largesymbols}{"55}
\re@DeclareMathSymbol{\bigwedgeop}{\mathop}{largesymbols}{"56}
\re@DeclareMathSymbol{\bigveeop}{\mathop}{largesymbols}{"57}
%\re@DeclareMathSymbol{\bigcupdotop}{\mathop}{largesymbols}{"DF}
%\re@DeclareMathSymbol{\bigcapplusop}{\mathop}{largesymbolsPXA}{"00}
%\re@DeclareMathSymbol{\bigsqcupplusop}{\mathop}{largesymbolsPXA}{"02}
%\re@DeclareMathSymbol{\bigsqcapplusop}{\mathop}{largesymbolsPXA}{"04}
%\re@DeclareMathSymbol{\bigsqcapop}{\mathop}{largesymbolsPXA}{"06}
\re@DeclareMathSymbol{\bigtimesop}{\mathop}{largesymbolsPXA}{"10}
%\re@DeclareMathSymbol{\coprodop}{\mathop}{largesymbols}{"60}
%\re@DeclareMathSymbol{\varprod}{\mathop}{largesymbolsPXA}{16}
\makeatother
%%
%% With euler font cursive for Greek letters - the [1] means 100% scaling
\DeclareFontFamily{U}{egreek}{\skewchar\font'177}%
\DeclareFontShape{U}{egreek}{m}{n}{<-6>s*[1]eurm5 <6-8>s*[1]eurm7 <8->s*[1]eurm10}{}%
\DeclareFontShape{U}{egreek}{m}{it}{<->s*[1]eurmo10}{}%
\DeclareFontShape{U}{egreek}{b}{n}{<-6>s*[1]eurb5 <6-8>s*[1]eurb7 <8->s*[1]eurb10}{}%
\DeclareFontShape{U}{egreek}{b}{it}{<->s*[1]eurbo10}{}%
\DeclareSymbolFont{egreeki}{U}{egreek}{m}{it}%
\SetSymbolFont{egreeki}{bold}{U}{egreek}{b}{it}% from the amsfonts package
\DeclareSymbolFont{egreekr}{U}{egreek}{m}{n}%
\SetSymbolFont{egreekr}{bold}{U}{egreek}{b}{n}% from the amsfonts package
% Take also \sum, \prod, \coprod symbols from Euler fonts
\DeclareFontFamily{U}{egreekx}{\skewchar\font'177}
\DeclareFontShape{U}{egreekx}{m}{n}{%
       <-7.5>s*[0.9]euex7%
    <7.5-8.5>s*[0.9]euex8%
    <8.5-9.5>s*[0.9]euex9%
    <9.5->s*[0.9]euex10%
}{}
\DeclareSymbolFont{egreekx}{U}{egreekx}{m}{n}
\DeclareMathSymbol{\sumop}{\mathop}{egreekx}{"50}
\DeclareMathSymbol{\prodop}{\mathop}{egreekx}{"51}
\DeclareMathSymbol{\coprodop}{\mathop}{egreekx}{"60}
\makeatletter
\def\sum{\DOTSI\sumop\slimits@}
\def\prod{\DOTSI\prodop\slimits@}
\def\coprod{\DOTSI\coprodop\slimits@}
\makeatother
\input{definegreek.tex}% Greek letters not usually given in LaTeX.

%\usepackage%[scaled=0.9]%
%{classico}%  Optima as sans-serif font
\renewcommand\sfdefault{uop}
\DeclareMathAlphabet{\mathsf}  {T1}{\sfdefault}{m}{sl}
\SetMathAlphabet{\mathsf}{bold}{T1}{\sfdefault}{b}{sl}
%\newcommand*{\mathte}[1]{\textbf{\textit{\textsf{#1}}}}
% Upright sans-serif math alphabet
% \DeclareMathAlphabet{\mathsu}  {T1}{\sfdefault}{m}{n}
% \SetMathAlphabet{\mathsu}{bold}{T1}{\sfdefault}{b}{n}

% DejaVu Mono as typewriter text
\usepackage[scaled=0.84]{DejaVuSansMono}

\usepackage{mathdots}

\usepackage[usenames]{xcolor}
% Tol (2012) colour-blind-, print-, screen-friendly colours, alternative scheme; Munsell terminology
\definecolor{mypurpleblue}{RGB}{68,119,170}
\definecolor{myblue}{RGB}{102,204,238}
\definecolor{mygreen}{RGB}{34,136,51}
\definecolor{myyellow}{RGB}{204,187,68}
\definecolor{myred}{RGB}{238,102,119}
\definecolor{myredpurple}{RGB}{170,51,119}
\definecolor{mygrey}{RGB}{187,187,187}
% Tol (2012) colour-blind-, print-, screen-friendly colours; Munsell terminology
% \definecolor{lbpurple}{RGB}{51,34,136}
% \definecolor{lblue}{RGB}{136,204,238}
% \definecolor{lbgreen}{RGB}{68,170,153}
% \definecolor{lgreen}{RGB}{17,119,51}
% \definecolor{lgyellow}{RGB}{153,153,51}
% \definecolor{lyellow}{RGB}{221,204,119}
% \definecolor{lred}{RGB}{204,102,119}
% \definecolor{lpred}{RGB}{136,34,85}
% \definecolor{lrpurple}{RGB}{170,68,153}
\definecolor{lgrey}{RGB}{221,221,221}
%\newcommand*\mycolourbox[1]{%
%\colorbox{mygrey}{\hspace{1em}#1\hspace{1em}}}
\colorlet{shadecolor}{lgrey}

\usepackage{bm}

\usepackage{microtype}

\usepackage[backend=biber,mcite,%subentry,
citestyle=authoryear-comp,bibstyle=pglpm-authoryear,autopunct=false,sorting=ny,sortcites=false,natbib=false,maxcitenames=1,maxbibnames=8,minbibnames=8,giveninits=true,uniquename=false,uniquelist=false,maxalphanames=1,block=space,hyperref=true,defernumbers=false,useprefix=true,sortupper=false,language=british,parentracker=false]{biblatex}
\DeclareSortingScheme{ny}{\sort{\field{sortname}\field{author}\field{editor}}\sort{\field{year}}}
\iffalse\makeatletter%%% replace parenthesis with brackets
\newrobustcmd*{\parentexttrack}[1]{%
  \begingroup
  \blx@blxinit
  \blx@setsfcodes
  \blx@bibopenparen#1\blx@bibcloseparen
  \endgroup}
\AtEveryCite{%
  \let\parentext=\parentexttrack%
  \let\bibopenparen=\bibopenbracket%
  \let\bibcloseparen=\bibclosebracket}
\makeatother\fi
\DefineBibliographyExtras{british}{\def\finalandcomma{\addcomma}}
\renewcommand*{\finalnamedelim}{\addcomma\space}
\setcounter{biburlnumpenalty}{1}
\setcounter{biburlucpenalty}{0}
\setcounter{biburllcpenalty}{1}
\DeclareDelimFormat{multicitedelim}{\addsemicolon\space}
\DeclareDelimFormat{compcitedelim}{\addsemicolon\space}
\DeclareDelimFormat{postnotedelim}{\space}
\ifarxiv\else\addbibresource{portamanabib.bib}\fi
\renewcommand{\bibfont}{\footnotesize}
%\appto{\citesetup}{\footnotesize}% smaller font for citations
\defbibheading{bibliography}[\bibname]{\section*{#1}\addcontentsline{toc}{section}{#1}%\markboth{#1}{#1}
}
\newcommand*{\citep}{\parencites}
\newcommand*{\citey}{\parencites*}
%\renewcommand*{\cite}{\parencite}
\renewcommand*{\cites}{\parencites}
\providecommand{\href}[2]{#2}
\providecommand{\eprint}[2]{\texttt{\href{#1}{#2}}}
\newcommand*{\amp}{\&}
% \newcommand*{\citein}[2][]{\textnormal{\textcite[#1]{#2}}%\addtocategory{extras}{#2}
% }
\newcommand*{\citein}[2][]{\textnormal{\textcite[#1]{#2}}%\addtocategory{extras}{#2}
}
\newcommand*{\citebi}[2][]{\textcite[#1]{#2}%\addtocategory{extras}{#2}
}
\newcommand*{\subtitleproc}[1]{}
\newcommand*{\chapb}{ch.}
%
% \def\arxivp{}
% \def\mparcp{}
% \def\philscip{}
% \def\biorxivp{}
% \newcommand*{\arxivsi}{\texttt{arXiv} eprints available at \url{http://arxiv.org/}.\\}
% \newcommand*{\mparcsi}{\texttt{mp\_arc} eprints available at \url{http://www.ma.utexas.edu/mp_arc/}.\\}
% \newcommand*{\philscisi}{\texttt{philsci} eprints available at \url{http://philsci-archive.pitt.edu/}.\\}
% \newcommand*{\biorxivsi}{\texttt{bioRxiv} eprints available at \url{http://biorxiv.org/}.\\}
\newcommand*{\arxiveprint}[1]{%\global\def\arxivp{\arxivsi}%\citeauthor{0arxivcite}\addtocategory{ifarchcit}{0arxivcite}%eprint
\texttt{\urlalt{https://arxiv.org/abs/#1}{arXiv:\hspace{0pt}#1}}%
%\texttt{\href{http://arxiv.org/abs/#1}{\protect\url{arXiv:#1}}}%
%\renewcommand{\arxivnote}{\texttt{arXiv} eprints available at \url{http://arxiv.org/}.}
}
\newcommand*{\mparceprint}[1]{%\global\def\mparcp{\mparcsi}%\citeauthor{0mparccite}\addtocategory{ifarchcit}{0mparccite}%eprint
\texttt{\urlalt{http://www.ma.utexas.edu/mp_arc-bin/mpa?yn=#1}{mp\_arc:\hspace{0pt}#1}}%
%\texttt{\href{http://www.ma.utexas.edu/mp_arc-bin/mpa?yn=#1}{\protect\url{mp_arc:#1}}}%
%\providecommand{\mparcnote}{\texttt{mp_arc} eprints available at \url{http://www.ma.utexas.edu/mp_arc/}.}
}
\newcommand*{\philscieprint}[1]{%\global\def\philscip{\philscisi}%\citeauthor{0philscicite}\addtocategory{ifarchcit}{0philscicite}%eprint
\texttt{\urlalt{http://philsci-archive.pitt.edu/archive/#1}{PhilSci:\hspace{0pt}#1}}%
%\texttt{\href{http://philsci-archive.pitt.edu/archive/#1}{\protect\url{PhilSci:#1}}}%
%\providecommand{\mparcnote}{\texttt{philsci} eprints available at \url{http://philsci-archive.pitt.edu/}.}
}
\newcommand*{\biorxiveprint}[1]{%\global\def\biorxivp{\biorxivsi}%\citeauthor{0arxivcite}\addtocategory{ifarchcit}{0arxivcite}%eprint
\texttt{\urlalt{https://doi.org/10.1101/#1}{bioRxiv doi:\hspace{0pt}10.1101/#1}}%
%\texttt{\href{http://arxiv.org/abs/#1}{\protect\url{arXiv:#1}}}%
%\renewcommand{\arxivnote}{\texttt{arXiv} eprints available at \url{http://arxiv.org/}.}
}
\newcommand*{\osfeprint}[1]{%
\texttt{\urlalt{https://doi.org/10.17605/osf.io/#1}{Open Science Framework doi:10.17605/osf.io/#1}}%
}

\usepackage{graphicx}

%\usepackage{wrapfig}

%\usepackage{tikz-cd}

\PassOptionsToPackage{hyphens}{url}\usepackage[hypertexnames=false]{hyperref}

\usepackage[depth=4]{bookmark}
\hypersetup{colorlinks=true,bookmarksnumbered,pdfborder={0 0 0.25},citebordercolor={0.2667 0.4667 0.6667},citecolor=mypurpleblue,linkbordercolor={0.6667 0.2 0.4667},linkcolor=myredpurple,urlbordercolor={0.1333 0.5333 0.2},urlcolor=mygreen,breaklinks=true,pdftitle={\pdftitle},pdfauthor={\pdfauthor}}
% \usepackage[vertfit=local]{breakurl}% only for arXiv
\providecommand*{\urlalt}{\href}

\usepackage[british]{datetime2}
\DTMnewdatestyle{mydate}%
{% definitions
\renewcommand*{\DTMdisplaydate}[4]{%
\number##3\ \DTMenglishmonthname{##2} ##1}%
\renewcommand*{\DTMDisplaydate}{\DTMdisplaydate}%
}
\DTMsetdatestyle{mydate}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Layout. I do not know on which kind of paper the reader will print the
%%% paper on (A4? letter? one-sided? double-sided?). So I choose A5, which
%%% provides a good layout for reading on screen and save paper if printed
%%% two pages per sheet. Average length line is 66 characters and page
%%% numbers are centred.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\ifafour\setstocksize{297mm}{210mm}%{*}% A4
\else\setstocksize{210mm}{5.5in}%{*}% 210x139.7
\fi
\settrimmedsize{\stockheight}{\stockwidth}{*}
\setlxvchars[\normalfont] %313.3632pt for a 66-characters line
\setxlvchars[\normalfont]
\setlength{\trimtop}{0pt}
\setlength{\trimedge}{\stockwidth}
\addtolength{\trimedge}{-\paperwidth}
% The length of the normalsize alphabet is 133.05988pt - 10 pt = 26.1408pc
% The length of the normalsize alphabet is 159.6719pt - 12pt = 30.3586pc
% Bringhurst gives 32pc as boundary optimal with 69 ch per line
% The length of the normalsize alphabet is 191.60612pt - 14pt = 35.8634pc
\ifafour\settypeblocksize{*}{32pc}{1.618} % A4
%\setulmargins{*}{*}{1.667}%gives 5/3 margins % 2 or 1.667
\else\settypeblocksize{*}{26pc}{1.618}% nearer to a 66-line newpx and preserves GR
\fi
\setulmargins{*}{*}{1}%gives equal margins
\setlrmargins{*}{*}{*}
\setheadfoot{\onelineskip}{2.5\onelineskip}
\setheaderspaces{*}{2\onelineskip}{*}
\setmarginnotes{2ex}{10mm}{0pt}
\checkandfixthelayout[nearest]
\fixpdflayout
%%% End layout
%% this fixes missing white spaces
\pdfmapline{+dummy-space <dummy-space.pfb}\pdfinterwordspaceon%

%%% Sectioning
\newcommand*{\asudedication}[1]{%
{\par\centering\textit{#1}\par}}
\newenvironment{acknowledgements}{\section*{%
%Basimeh% Assirian
%Bedankt% Dutch
Baraka%
% Thanks...
}\addcontentsline{toc}{section}{Thanks}}{\par}
\makeatletter\renewcommand{\appendix}{\par
  \bigskip{\centering
   \interlinepenalty \@M
   \normalfont
   \printchaptertitle{\sffamily\appendixpagename}\par}
  \setcounter{section}{0}%
  \gdef\@chapapp{\appendixname}%
  \gdef\thesection{\@Alph\c@section}%
  \anappendixtrue}\makeatother
\counterwithout{section}{chapter}
\setsecnumformat{\upshape\csname the#1\endcsname\quad}
\setsecheadstyle{\large\bfseries\sffamily%
\centering}
\setsubsecheadstyle{\bfseries\sffamily%
\raggedright}
%\setbeforesecskip{-1.5ex plus 1ex minus .2ex}% plus 1ex minus .2ex}
%\setaftersecskip{1.3ex plus .2ex }% plus 1ex minus .2ex}
%\setsubsubsecheadstyle{\bfseries\sffamily\slshape\raggedright}
%\setbeforesubsecskip{1.25ex plus 1ex minus .2ex }% plus 1ex minus .2ex}
%\setaftersubsecskip{-1em}%{-0.5ex plus .2ex}% plus 1ex minus .2ex}
\setsubsecindent{0pt}%0ex plus 1ex minus .2ex}
\setparaheadstyle{\bfseries\sffamily%
\raggedright}
\setcounter{secnumdepth}{2}
\setlength{\headwidth}{\textwidth}
\newcommand{\addchap}[1]{\chapter*[#1]{#1}\addcontentsline{toc}{chapter}{#1}}
\newcommand{\addsec}[1]{\section*{#1}\addcontentsline{toc}{section}{#1}}
\newcommand{\addsubsec}[1]{\subsection*{#1}\addcontentsline{toc}{subsection}{#1}}
\newcommand{\addpara}[1]{\paragraph*{#1.}\addcontentsline{toc}{subsubsection}{#1}}
\newcommand{\addparap}[1]{\paragraph*{#1}\addcontentsline{toc}{subsubsection}{#1}}

%%% Headers, footers, pagestyle
\copypagestyle{manaart}{plain}
\makeheadrule{manaart}{\headwidth}{0.5\normalrulethickness}
\makeoddhead{manaart}{%
{\footnotesize%\sffamily%
\scshape\headauthor}}{}{{\footnotesize\sffamily%
\headtitle}}
\makeoddfoot{manaart}{}{\thepage}{}
\newcommand*\autanet{\includegraphics[height=\heightof{M}]{autanet.pdf}}
\definecolor{mygray}{gray}{0.333}
\iftypodisclaim%
\ifafour\newcommand\addprintnote{\begin{picture}(0,0)%
\put(245,149){\makebox(0,0){\rotatebox{90}{\tiny\color{mygray}\textsf{This
            document is designed for screen reading and
            two-up printing on A4 or Letter paper}}}}%
\end{picture}}% A4
\else\newcommand\addprintnote{\begin{picture}(0,0)%
\put(176,112){\makebox(0,0){\rotatebox{90}{\tiny\color{mygray}\textsf{This
            document is designed for screen reading and
            two-up printing on A4 or Letter paper}}}}%
\end{picture}}\fi%afourtrue
\makeoddfoot{plain}{}{\makebox[0pt]{\thepage}\addprintnote}{}
\else
\makeoddfoot{plain}{}{\makebox[0pt]{\thepage}}{}
\fi%typodisclaimtrue
\makeoddhead{plain}{}{}{\footnotesize\reporthead}
% \copypagestyle{manainitial}{plain}
% \makeheadrule{manainitial}{\headwidth}{0.5\normalrulethickness}
% \makeoddhead{manainitial}{%
% \footnotesize\sffamily%
% \scshape\headauthor}{}{\footnotesize\sffamily%
% \headtitle}
% \makeoddfoot{manaart}{}{\thepage}{}

\pagestyle{manaart}

\setlength{\droptitle}{-3.9\onelineskip}
\pretitle{\begin{center}%
%\Large\sffamily\bfseries%
\LARGE\sffamily\bfseries%
}
\posttitle{\bigskip\end{center}}

\makeatletter\newcommand*{\atf}{\includegraphics[%trim=1pt 1pt 0pt 0pt,
totalheight=\heightof{@}]{atblack.png}}\makeatother
\providecommand{\affiliation}[1]{\textsl{\textsf{\footnotesize #1}}}
\providecommand{\epost}[1]{\texttt{\footnotesize\textless#1\textgreater}}
\providecommand{\email}[2]{\href{mailto:#1ZZ@#2 ((remove ZZ))}{#1\protect\atf#2}}

\preauthor{\vspace{0\baselineskip}\begin{center}
\normalsize\sffamily%
\lineskip  0.5em}
\postauthor{\par\end{center}}
\predate{\DTMsetdatestyle{mydate}\begin{center}\footnotesize}
\postdate{\end{center}\vspace{-\medskipamount}}

\setfloatadjustment{figure}{\footnotesize}
\captiondelim{\quad}
\captionnamefont{\footnotesize\sffamily%
}
\captiontitlefont{\footnotesize}
\firmlists*
\midsloppy
% handling orphan/widow lines, memman.pdf
% \clubpenalty=10000
% \widowpenalty=10000
% \raggedbottom
% Downes, memman.pdf
\clubpenalty=9996
\widowpenalty=9999
\brokenpenalty=4991
\predisplaypenalty=10000
\postdisplaypenalty=1549
\displaywidowpenalty=1602
\selectlanguage{british}\frenchspacing

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Paper's details
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newlength{\myla}
\settowidth{\myla}{\footnotesize\slshape\textless piero.mana@ntnu.no\textgreater}
\newlength{\mylb}
\settowidth{\mylb}{\footnotesize\slshape\textless claudia.battistin@gmail.com\textgreater}
\newlength{\mylc}
\settowidth{\mylc}{\footnotesize\slshape\textless soledad.g.cogno@ntnu.no\textgreater}
\title{\propertitle}
\author{%
\hspace*{\stretch{1}}%
%% uncomment if additional authors present
\parbox{0.33\linewidth}%\makebox[0pt][c]%
{\protect\centering P.G.L.  Porta Mana\\%
\footnotesize\epost{\email{piero.mana}{ntnu.no}}}%
\hspace*{\stretch{100}}\mbox{}\\%
\hspace*{\stretch{1}}%
\parbox{0.33\linewidth}%\makebox[0pt][c]%
{\protect\centering C. Battistin\\%
\footnotesize\epost{\email{claudia.battistin}{gmail.com}}}%
\hspace*{\stretch{1}}\mbox{}\\%
\hspace*{\stretch{100}}%
\parbox{0.33\linewidth}%\makebox[0pt][c]%
{\protect\centering S. Gonzalo Cogno\\%
\footnotesize\epost{\email{soledad.g.cogno}{ntnu.no}}}%
\hspace*{\stretch{1}}\mbox{}%
%\quad\href{https://orcid.org/0000-0002-6070-0784}{\protect\includegraphics[scale=0.16]{orcid_32x32.png}\textsc{orcid}:0000-0002-6070-0784}%
}

\date{Draft of \today\ (first drafted \firstdraft)}
%\date{\firstpublished; updated \updated}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Macros @@@
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Common ones - uncomment as needed
%\providecommand{\nequiv}{\not\equiv}
%\providecommand{\coloneqq}{\mathrel{\mathop:}=}
%\providecommand{\eqqcolon}{=\mathrel{\mathop:}}
%\providecommand{\varprod}{\prod}
\newcommand*{\de}{\partialup}%partial diff
\newcommand*{\pu}{\piup}%constant pi
\newcommand*{\delt}{\deltaup}%Kronecker, Dirac
%\newcommand*{\eps}{\varepsilonup}%Levi-Civita, Heaviside
%\newcommand*{\riem}{\zetaup}%Riemann zeta
%\providecommand{\degree}{\textdegree}% degree
%\newcommand*{\celsius}{\textcelsius}% degree Celsius
%\newcommand*{\micro}{\textmu}% degree Celsius
\newcommand*{\I}{\mathrm{i}}%imaginary unit
\newcommand*{\e}{\mathrm{e}}%Neper
\newcommand*{\di}{\mathrm{d}}%differential
%\newcommand*{\Di}{\mathrm{D}}%capital differential
%\newcommand*{\planckc}{\hslash}
%\newcommand*{\avogn}{N_{\textrm{A}}}
%\newcommand*{\NN}{\bm{\mathrm{N}}}
%\newcommand*{\ZZ}{\bm{\mathrm{Z}}}
%\newcommand*{\QQ}{\bm{\mathrm{Q}}}
\newcommand*{\RR}{\bm{\mathrm{R}}}
%\newcommand*{\CC}{\bm{\mathrm{C}}}
%\newcommand*{\nabl}{\bm{\nabla}}%nabla
%\DeclareMathOperator{\lb}{lb}%base 2 log
%\DeclareMathOperator{\tr}{tr}%trace
%\DeclareMathOperator{\card}{card}%cardinality
%\DeclareMathOperator{\im}{Im}%im part
%\DeclareMathOperator{\re}{Re}%re part
%\DeclareMathOperator{\sgn}{sgn}%signum
%\DeclareMathOperator{\ent}{ent}%integer less or equal to
%\DeclareMathOperator{\Ord}{O}%same order as
%\DeclareMathOperator{\ord}{o}%lower order than
\newcommand*{\incr}{\triangle}%finite increment
\newcommand*{\defd}{\coloneqq}
\newcommand*{\defs}{\eqqcolon}
%\newcommand*{\Land}{\bigwedge}
%\newcommand*{\Lor}{\bigvee}
%\newcommand*{\lland}{\DOTSB\;\land\;}
%\newcommand*{\llor}{\DOTSB\;\lor\;}
%\newcommand*{\limplies}{\mathbin{\Rightarrow}}%implies
%\newcommand*{\suchthat}{\mid}%{\mathpunct{|}}%such that (eg in sets)
%\newcommand*{\with}{\colon}%with (list of indices)
%\newcommand*{\mul}{\times}%multiplication
%\newcommand*{\inn}{\cdot}%inner product
%\newcommand*{\dotv}{\mathord{\,\cdot\,}}%variable place
%\newcommand*{\comp}{\circ}%composition of functions
%\newcommand*{\con}{\mathbin{:}}%scal prod of tensors
%\newcommand*{\equi}{\sim}%equivalent to 
\renewcommand*{\asymp}{\simeq}%equivalent to 
%\newcommand*{\corr}{\mathrel{\hat{=}}}%corresponds to
%\providecommand{\varparallel}{\ensuremath{\mathbin{/\mkern-7mu/}}}%parallel (tentative symbol)
\renewcommand*{\le}{\leqslant}%less or equal
\renewcommand*{\ge}{\geqslant}%greater or equal
%\DeclarePairedDelimiter\clcl{[}{]}
%\DeclarePairedDelimiter\clop{[}{[}
%\DeclarePairedDelimiter\opcl{]}{]}
%\DeclarePairedDelimiter\opop{]}{[}
\DeclarePairedDelimiter\abs{\lvert}{\rvert}
%\DeclarePairedDelimiter\norm{\lVert}{\rVert}
\DeclarePairedDelimiter\set{\{}{\}}
%\DeclareMathOperator{\pr}{P}%probability
\newcommand*{\pf}{\mathrm{p}}%probability
\newcommand*{\p}{\mathrm{P}}%probability
%\newcommand*{\E}{\mathrm{E}}
\renewcommand*{\|}{\nonscript\,\vert\nonscript\;\mathopen{}}
%\DeclarePairedDelimiterX{\cond}[2]{(}{)}{#1\nonscript\,\delimsize\vert\nonscript\;\mathopen{}#2}
%\DeclarePairedDelimiterX{\condt}[2]{[}{]}{#1\nonscript\,\delimsize\vert\nonscript\;\mathopen{}#2}
%\DeclarePairedDelimiterX{\conds}[2]{\{}{\}}{#1\nonscript\,\delimsize\vert\nonscript\;\mathopen{}#2}
%\newcommand*{\+}{\lor}
%\renewcommand{\*}{\land}
\newcommand*{\sect}{\S}% Sect.~
\newcommand*{\sects}{\S\S}% Sect.~
\newcommand*{\chap}{ch.}%
\newcommand*{\chaps}{chs}%
\newcommand*{\bref}{ref.}%
\newcommand*{\brefs}{refs}%
%\newcommand*{\fn}{fn}%
\newcommand*{\eqn}{eq.}%
\newcommand*{\eqns}{eqs}%
\newcommand*{\fig}{fig.}%
\newcommand*{\figs}{figs}%
\newcommand*{\vs}{{vs}}
%\newcommand*{\etc}{{etc.}}
%\newcommand*{\ie}{{i.e.}}
%\newcommand*{\ca}{{c.}}
\newcommand*{\eg}{{e.g.}}
\newcommand*{\foll}{{ff.}}
%\newcommand*{\viz}{{viz}}
\newcommand*{\cf}{{cf.}}
%\newcommand*{\Cf}{{Cf.}}
%\newcommand*{\vd}{{v.}}
\newcommand*{\etal}{{et al.}}
%\newcommand*{\etsim}{{et sim.}}
%\newcommand*{\ibid}{{ibid.}}
%\newcommand*{\sic}{{sic}}
%\newcommand*{\id}{\mathte{I}}%id matrix
%\newcommand*{\nbd}{\nobreakdash}%
%\newcommand*{\bd}{\hspace{0pt}}%
%\def\hy{-\penalty0\hskip0pt\relax}
%\newcommand*{\labelbis}[1]{\tag*{(\ref{#1})$_\text{r}$}}
%\newcommand*{\mathbox}[2][.8]{\parbox[t]{#1\columnwidth}{#2}}
%\newcommand*{\zerob}[1]{\makebox[0pt][l]{#1}}
\newcommand*{\tprod}{\mathop{\textstyle\prod}\nolimits}
\newcommand*{\tsum}{\mathop{\textstyle\sum}\nolimits}
%\newcommand*{\tint}{\begingroup\textstyle\int\endgroup\nolimits}
%\newcommand*{\tland}{\mathop{\textstyle\bigwedge}\nolimits}
%\newcommand*{\tlor}{\mathop{\textstyle\bigvee}\nolimits}
%\newcommand*{\sprod}{\mathop{\textstyle\prod}}
%\newcommand*{\ssum}{\mathop{\textstyle\sum}}
%\newcommand*{\sint}{\begingroup\textstyle\int\endgroup}
%\newcommand*{\sland}{\mathop{\textstyle\bigwedge}}
%\newcommand*{\slor}{\mathop{\textstyle\bigvee}}
%\newcommand*{\T}{^\intercal}%transpose
%%\newcommand*{\QEM}%{\textnormal{$\Box$}}%{\ding{167}}
%\newcommand*{\qem}{\leavevmode\unskip\penalty9999 \hbox{}\nobreak\hfill
%\quad\hbox{\QEM}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Custom macros for this file @@@
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 \definecolor{notecolour}{RGB}{68,170,153}
\newcommand*{\puzzle}{{\fontencoding{U}\fontfamily{fontawesometwo}\selectfont\symbol{225}}}
%\newcommand*{\puzzle}{\maltese}
\newcommand{\mynote}[1]{ {\color{notecolour}\puzzle\ #1}}
\newcommand*{\widebar}[1]{{\mkern1.5mu\skew{2}\overline{\mkern-1.5mu#1\mkern-1.5mu}\mkern 1.5mu}}

% \newcommand{\explanation}[4][t]{%\setlength{\tabcolsep}{-1ex}
% %\smash{
% \begin{tabular}[#1]{c}#2\\[0.5\jot]\rule{1pt}{#3}\\#4\end{tabular}}%}
% \newcommand*{\ptext}[1]{\text{\small #1}}
%\DeclareMathOperator*{\argsup}{arg\,sup}
\newcommand*{\dob}{degree of belief}
\newcommand*{\dobs}{degrees of belief}
\newcommand*{\ym}{\mathord{-}}
\newcommand*{\yp}{\mathord{+}}
\newcommand*{\yrm}{r^{-}}
\newcommand*{\yrp}{r^{+}}
\newcommand*{\yfm}{f^{-}}
\newcommand*{\yfp}{f^{+}}
\newcommand*{\yfvm}{\bm{f}^{-}}
\newcommand*{\yfvp}{\bm{f}^{+}}
\newcommand*{\yqm}{q^{-}}
\newcommand*{\yqp}{q^{+}}
\newcommand*{\yqvm}{\bm{q}^{-}}
\newcommand*{\yqvp}{\bm{q}^{+}}
\newcommand*{\yI}{K}
\newcommand*{\yIu}{K_{\text{u}}}
\newcommand*{\yIc}{K_{\text{c}}}
%%% Custom macros end @@@

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Beginning of document
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\firmlists
\begin{document}
\captiondelim{\quad}\captionnamefont{\footnotesize}\captiontitlefont{\footnotesize}
\selectlanguage{british}\frenchspacing
\maketitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Abstract
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\abstractrunin
\abslabeldelim{}
\renewcommand*{\abstractname}{}
\setlength{\absleftindent}{0pt}
\setlength{\absrightindent}{0pt}
\setlength{\abstitleskip}{-\absparindent}
\begin{abstract}\labelsep 0pt%
  \noindent This note shows a direct route to forecast the mutual
  information of stimulus-response long-run frequencies from sample data of
  any size. Using an intuitive example it is demonstrated that our pre-data
  forecast about the long-run frequencies is crucial when the sample is
  small. It turns out that estimates considered \enquote{biased} in some
  literature should be considered seriously instead: the response is indeed
  very likely to be informative.% A
  % correct frequentist analysis also shows that the frequentist estimator is
  % unbiased. No corrections of any kind are needed.
  % 
  \\\noindent\emph{\footnotesize Note: Dear Reader \amp\ Peer, this
    manuscript is being peer-reviewed by you. Thank you.}
% \par%\\[\jot]
% \noindent
% {\footnotesize PACS: ***}\qquad%
% {\footnotesize MSC: ***}%
%\qquad{\footnotesize Keywords: ***}
\end{abstract}
\selectlanguage{british}\frenchspacing

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Epigraph
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \asudedication{\small ***}
% \vspace{\bigskipamount}
% \setlength{\epigraphwidth}{.7\columnwidth}
% %\epigraphposition{flushright}
% \epigraphtextposition{flushright}
% %\epigraphsourceposition{flushright}
% \epigraphfontsize{\footnotesize}
% \setlength{\epigraphrule}{0pt}
% %\setlength{\beforeepigraphskip}{0pt}
% %\setlength{\afterepigraphskip}{0pt}
% \epigraph{\emph{text}}{source}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% BEGINNING OF MAIN TEXT
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Bias?}
\label{sec:intro}

The mutual information between the long-run relative frequency of a signal
and that of a response is a measure of how much our uncertainty about the
signal is reduced by knowledge of the response. This measure is sometimes
used in neuroscience, the response being some characteristic -- such as the
activity or the firing rate -- of a neuron or of a network of neurons.

In this note we show a direct route to forecast the long-run mutual
information, given a sample of stimulus-response frequencies. The forecast
consists in a probability distribution for the values of the long-run
mutual information. The sample can be of any size.

The intuitive reliability of the forecast is shown by a simple numerical
example. The example also shows that the forecast always depends on our pre-data
forecast of the response frequencies -- the more so the smaller the sample
is.

Our analysis is pertinent to recent works in neuroscience
\citep{panzerietal2007}\mynote{add others} that use a more topsy-turvy
approach to this inference problem. These works try to correct
\enquote{biased} estimates that appear to predict too high values of the
long-run mutual information when the sample size is small. The example we
present shows that such \enquote{biased} estimates may have to be taken
seriously instead: we should indeed expect the response to be very
informative. This depends, again, on our pre-data forecast for the response
frequencies.

For small samples it's therefore important to be very judicious in our
pre-data forecasts. We discuss some methods, used in many other fields, to
make such educated assessments.

% claim that our estimate about the mutual information for long-run
% frequencies from a small sample is biased; that is, in frequentist terms:
% the expected value of its sample estimate is different from its
% \enquote{true} value. Other works have proposed various corrections to this
% alleged bias.

% In this note we show three main results:
% \begin{enumerate}[label=\arabic*.,wide]
% \item The direct estimation of the \enquote{long-run} mutual information
%   from a sample is reliable and doesn't need any kind of correction. On the
%   one hand, if we are equally uncertain about the long-run response
%   frequencies, and the estimate from a small sample suggests a large mutual
%   information, then we should indeed expect the response to be informative.
%   On the other hand, if we initially suspect that the long-run response
%   frequencies should be uninformative, or if we are very conservative in
%   our inference, then a correct calculation consistently leads to very low
%   estimates of the mutual information.
% \item For small samples, our estimate crucially depends on the pre-data
%   probability for the long-run relative frequencies of the response
%   conditional on the stimulus. In making such estimates we must therefore
%   give some thought to assessing this pre-data probability, rather than
%   correcting non-existing biases.
% \item The distribution of mutual information obtained with the sampling
%   procedure in \textcite{panzerietal2007} for a pair of uniform conditional
%   frequencies actually makes sense: we should expect such a large mutual
%   information from those data.
% \end{enumerate}

% The main result is first shown in the next section with a straightforward
% calculation, and explained intuitively in the subsequent section. The
% calculations use the example given by \textcite[Fig.~1]{panzerietal2007}.
% The final section briefly discusses the third result and the importance of
% the pre-data probability in our estimations when the sample is small. Some
% ways to assess this probability are also discussed.

% % \mynote{Comment on \enquote{sampling bias}: it has a different meaning in statistics}

\section{Bayes}
\label{sec:bias_bayes}

First of all let's state what our inference is about. Given a sample of
stimulus-response data we want to assess what's the most probable set of
long-run\footnote{\enquote{But this \emph{long run} is a misleading guide
    to current affairs. \emph{In the long run} we are all dead.}
  \citep[\sect~3.I, p.~65]{keynes1923_r2013}} relative frequencies of the
response conditional on each stimulus value, and from these assess what's
the most probable value of the associated mutual information between
stimulus and response. We assume that all stimuli appear with equal
relative frequencies.

Let the stimulus $s$ have two possible values $\set{\ym,\yp}$, and the
response $r$ ten possible values $\set{1,\dotsc, 10}$. Let the data $D$ be
a set of $n$ stimuli $\ym$ which yielded $n$ responses $(\yrm_i)$,
$i \in \set{1,\dotsc, n}$, and $n$ stimuli $\yp$ which yielded $n$
responses $(\yrp_i)$. The ten response state appeared with relative
frequencies $\yqvm \defd (\yqm_r)$, $r \in \set{1,\dotsc,10}$, for the
stimulus $\ym$, and with relative frequencies $\yqvp \defd (\yqp_r)$ for
the stimulus $\yp$.

We can use the concrete data summarized in
\fig~\ref{fig:sample_histograms}, consisting in $n=20$ samples per
stimulus.
\begin{figure}[h!]
\centering\includegraphics[width=\linewidth]{samples.png}\\
\caption{}\label{fig:sample_histograms}
\end{figure}% finite_sampling_bullshit.nb

If the long-run frequencies conditional on stimulus $\ym$ are
$\yfvm \defd (\yfm_r)$, and conditional on $\yp$, $\yfvp \defd (\yfp_r)$,
then out of symmetry the probability of obtaining the data $D$ is
\begin{equation}
  \label{eq:prob_data_from_freqs}
  \pf(D \| \yfvm, \yfvp, \yI) =
  \prod_r \Bigl[  (\yfm_r)^{n\yqm_r}\;  (\yfp_r)^{n\yqp_r}\Bigr].
\end{equation}
This is also the \emph{likelihood} of the long-run frequencies in view of
the sample. Their probability density is proportional to the likelihood,
corrected by their initial probabilities $\pf(\yfvm, \yfvp \| \yI)$
\begin{multline}
  \label{eq:prob_freqs_from_data}
  \pf(\yfvm, \yfvp \| D, \yI) \propto
  \pf(D \| \yfvm, \yfvp, \yI) \; \pf(\yfvm, \yfvp \| \yI) ={}\\
  \pf(\yfvm, \yfvp \| \yI)\;
  \prod_r \Bigl[  (\yfm_r)^{n\yqm_r}\;  (\yfp_r)^{n\yqp_r}\Bigr].
\end{multline}

We can calculate this probability analytically when possible, or estimate
it with Monte Carlo sampling. From such samples we estimate the probability
distribution of the long-run mutual information
\begin{equation}
  \label{eq:mutual_info}
  I \defd \sum_r \tfrac{1}{2}\yfvm_r\;
  \ln\Biggl(\frac{\frac{1}{2}\yfvm_r}{
    \frac{1}{2}\yfvm_r + \frac{1}{2}\yfvp_r}
  \Biggr) +
  \sum_r \tfrac{1}{2}\yfvp_r\;
  \ln\Biggl(\frac{\frac{1}{2}\yfvp_r}{
    \frac{1}{2}\yfvm_r + \frac{1}{2}\yfvp_r}
  \Biggr).
\end{equation}

Let's consider two possible probabilities for the long-run conditional
frequencies: \textcolor{white}{If you find this you can claim a postcard from me.}


\subsection{Uniform uncertainty about the frequencies}
\label{sec:credib_unif}

If we initially think that equal ranges $(\incr\yfvm, \incr\yfvp)$ of pairs
of conditional frequencies are equally possible, then
\begin{equation}
  \label{eq:credib_unif}
    \pf(\yfvm, \yfvp \| \yIu) = 1.
\end{equation}

We sample $5\,000$ pairs of conditional frequencies from the
density~\eqref{eq:prob_freqs_from_data} obtained from our example data and
this pre-data probability. The resulting distribution of their associated
mutual information is shown in \fig~\ref{fig:mutual_info_histo_unif}.
\begin{figure}[h!]
\centering\includegraphics[width=0.5\linewidth]{A_mutualinfo_hist.png}\\
\caption{}\label{fig:mutual_info_histo_unif}
\end{figure}% finite_sampling_bullshit.nb
It tells us that the response is likely to be informative; the most likely
values of the long-range mutual information are around $0.2\,\textrm{bit}$.
The next section explains intuitively why this probability distribution is
correct.

\subsection{Conservative uncertainty about the frequencies}
\label{sec:credib_cons}

If we initially think that the long-run response frequencies conditional on
the stimuli should be very similar, or if we simply want to do a
conservative estimate, then our pre-data probability must be higher for
pairs with similar conditional frequencies; for example \mynote{replace
  with combination of Dirichlet -- same effect}
\begin{equation}
  \label{eq:credib_cons}
  \pf(\yfvm, \yfvp \| \yIc) \propto \exp\Biggl[
\frac{\sum_r(\yfm_r - \yfp_r)^2}{2\sigma^2}
  \Biggr].
\end{equation}
This density states that the two conditional frequencies should be roughly
equal, but otherwise leaves a uniform uncertainty about the values of each.
Smaller values of $\sigma$ represent more conservative estimates.

A sample of $5\,000$ pairs of conditional frequencies from the
density~\eqref{eq:prob_freqs_from_data} with the conservative initial
density~\eqref{eq:credib_cons} \mynote{specify $\sigma$} leads to the
distribution of mutual information of
\fig~\ref{fig:mutual_info_histo_cons}.
\begin{figure}[h!]
\centering\includegraphics[width=0.5\linewidth]{B_mutualinfo_hist.png}\\
\caption{}\label{fig:mutual_info_histo_cons}
\end{figure}% finite_sampling_bullshit.nb
The estimate now says that we should
expect a negligible mutual information, with a most probable value around
100 times smaller than in the previous case.

\section{Because}
\label{sec:intuitive_understanding}

Let's try to understand why the estimate of \sect~\ref{sec:credib_unif},
\fig~\ref{fig:mutual_info_histo_unif}, is reliable; and to understand what
happens in the conservative case of \sect~\ref{sec:credib_cons}.

If we deem all pairs of conditional frequencies equally possible, we can
sample $5\,000$ pairs uniformly. Figure~\ref{fig:f1_unif} shows the
resulting scatter plot for first component of the two conditional
frequencies, that is, the frequency of the response value $1$.
\begin{figure}[h!]
\centering\includegraphics[width=0.5\linewidth]{A_sample_f1.png}\\
\caption{}\label{fig:f1_unif}
\end{figure}% finite_sampling_bullshit.nb

Let's now visualize the samples of long-run conditional frequencies in two
dimensions as follows: for each sample, the horizontal coordinate is the
probability that the frequencies assigns to our observed data; and the
vertical coordinate is the mutual information associated with the
frequencies. We obtain the scatter plot of
\fig~\ref{fig:init_scatter_unif}.
\begin{figure}[h!]
\centering\includegraphics[width=0.75\linewidth]{A_init_scatter.png}\\
\caption{}\label{fig:init_scatter_unif}
\end{figure}% finite_sampling_bullshit.nb
All points, of three different sizes and colours, are part of the plot. The
pair of two uniform conditional frequencies ($1/10$ probability for each
response) is the largest, yellow point. This pair of long-run conditional
frequencies assigns probability $10^{-40}$ to the data and has zero mutual
information.

It's clear from this scatter plot that the data strongly suggest a large
estimated mutual information, for two reasons:
\begin{enumerate}[label=\arabic*.]
\item All pairs that assign very low probability to our data, say less than
  $10^{-40}$, are represented by small blue points. Each one is very
  unlikely to be the continuation of our data. But at the same time they
  constitute the overwhelming majority of possible pairs, and therefore
  there is a non-negligible probability that the data come from one of
  them. Most of them have high mutual information.
\item The pairs that assign higher probability to our data, $10^{-40}$ or
  more, are represented by the larger red points and the largest yellow
  point. The majority of these pairs also have high mutual information. In
  fact, the pair of uniform conditional frequencies is an outlier: it's
  very unlikely that our data come from it, compared with the other
  possible pairs of frequencies.
\end{enumerate}
The estimate of \fig~\ref{fig:mutual_info_histo_unif} is therefore quite
correct and reliable.

\medskip

Now consider the conservative initial density~\eqref{eq:credib_cons}, and
sample $5\,000$ pairs of conditional frequencies from it. The scatter plot
for the first components of the sampled frequencies is shown in
\fig~\ref{fig:f1_cons}.
\begin{figure}[h!]
\centering\includegraphics[width=0.5\linewidth]{B_sample_f1.png}\\
\caption{}\label{fig:f1_cons}
\end{figure}% finite_sampling_bullshit.nb
It shows that the two long-run frequencies are very similar to each other and close
to $1/10$, the probability given by the uniform distribution.


Figure~\ref{fig:init_scatter_cons} shows the pairs of long-run frequencies
plotted as in the previous case. There are now many pairs that assign
roughly the same probability to the data as the uniform-distribution pair
does. The majority of all pairs has a negligible mutual information. This
is indeed reflected by the estimate of
\fig~\ref{fig:mutual_info_histo_cons}.
\begin{figure}[b!]
\centering\includegraphics[width=0.75\linewidth]{B_init_scatter.png}\\
\caption{}\label{fig:init_scatter_cons}
\end{figure}% finite_sampling_bullshit.nb


\section{Brief}
\label{sec:discussion}


We have calculated the probability distribution for the long-run mutual
information, given our knowledge of a small sample. The calculation was
conceptually straightforward and needed no corrections, even if it may
require numerical sampling methods. \mynote{Mention partial
  exchangeability.} We also saw (\sect~\ref{sec:intuitive_understanding})
why the distribution thus fund is intuitively correct. The crucial point is
the specification of the pre-data joint probability for the long-run
conditional frequencies. This specification is especially important if the
data are few. It's possible to specify a pre-data probability that express
a conservative guess, and the resulting estimate of the mutual information
is very close to zero.

This conclusion isn't surprising: the main point is the same as, for
example, in the inference of diseases or some phenotypes from genetic
peculiarities and vice versa. Imagine that we know the relative frequencies
of two gene variants among people who have a particular disease, and the
relative frequencies among people who don't have the disease. Now we ask:
given that a specific person has one of the gene variants, what's the
probability that this person has the disease? The answer is that in general
we don't know until we specify the incidence rate of the disease in the
full population. Because even if that gene variant appears more frequently among
people with the disease, the number of people having such disease may be so
small that the probability still favours the person's being healthy.

The direct calculation via the probability calculus
\citep{jaynes1994_r2003,soxetal1988_r2013,hailperin1996} makes any
discussion about biases superfluous. We'd nevertheless like to discuss the
distribution for the mutual information obtained by the sampling procedure
in \citep{panzerietal2007} for a pair of uniform conditional frequencies.
Such a distribution makes sense: the long-run mutual information obtained
from that small data sample should indeed be expected to be large.

The reason for this phenomenon can be explained by looking at
\fig~\ref{fig:init_scatter_unif}. We see that for our example data, the
pair of uniform distributions is an outlier: there are many other pairs
that have larger likelihoods under that dataset. It turns out that for
\emph{most} small datasets generated by a pair of uniform distributions,
the latter pair is an outlier; there are always many other pairs with
larger likelihoods. The sampling procedure is implicitly selecting those
more likely pairs and taking \emph{their} mutual information as most
likely. \mynote{The problem is that a small sample is as likely to have
  been generated by a uniform pair as by all possible pairs. Show the
  calculation about this.}


% Note, however, that a serious
% frequentist statistician would also find that the estimator of the mutual
% information is \emph{un}biased. The erroneous conclusions reached in papers
% claiming a sampling bias for mutual information
% \citep{panzerietal2007}\mynote{add others} may be summarized thus: they
% confuse a \emph{non-parametric} problem \citep[see \eg][\!\!, a frequentist
% book]{wasserman2006} with a parametric one. The problem is not the
% estimation of a parameter that identifies a distribution in a family, but
% the estimation of the distribution itself: the whole distribution -- or
% distribution\textbf{\emph{s}} in our case -- is the \enquote{parameter}.
% The mutual information is a function of this \enquote{parameter}. The
% procedure of Panzeri \etal\ \citey[pp.~1065--1066]{panzerietal2007} is
% therefore wrong.\footnote{Note in passing that plotting the distribution of
%   a parameter or of a function thereof, as in \textcite[Fig.~1, right
%   columns]{panzerietal2007}, is anathema from a frequentist point of view:
%   parameters do not have distributions, by divine Fisherian decree.} To
% assess the expectation of the estimator we must sample the
% \enquote{parameter}; in our case this means drawing $N$ samples of the
% empirical conditional frequencies in $n$ data and then taking their average
% to estimate the long-run frequency. The latter is a notoriously unbiased
% estimator. \emph{Then} we compute the mutual information from this
% estimate. If we do this with $N=5\,000$ and $n=20$ for a pair of uniform
% conditional distributions we obtain a mutual-information estimate of the
% order of $10^{-5}$. As $N$ increases, with $n=20$ fixed, the estimate goes
% to zero. There is no bias.

The topsy-turvy point of view typical of frequentist-like analyses
unfortunately leads to this kind of oversights. Our problem is not to infer
data from a specific known frequency, but to infer an unknown frequency
\emph{among several possible ones} from known data -- because our
uncertainty about the long-run mutual information is a consequence of our
uncertainty about the long-run frequency.

\bigskip

\mynote{Paragraph on shrinkage}


% From a frequentist point of view, the \enquote{unknown distribution} is not
% the pair of conditional frequencies, but \emph{their} distribution
% $\p(\yfm,\yfp)$ (the fact that they're (a) a pair, (b) conditional, should
% already warn us about this). This is a so-called non-parametric problem,
% and the two conditional frequencies have rather the role of a parameter
% here. From this frequentist point of view the estimate of the mutual
% information~\ref{fig:mutual_info_histo_unif} is not biased or has at most a
% negligible correction factor (similar to the \enquote{$n/(n-1)$} factor for
% the variance estimator).


% The erroneous conclusions reached in Panzeri \etal\ \citey{panzerietal2007}
% stem from a combination of mutually connected oversights. First of all the
% analysis given there is a little topsy-turvy: our problem is not to infer
% data from a specific known frequency, but to infer an unknown frequency
% \emph{among several possible ones} from known data -- because our
% uncertainty about the long-run mutual information is a consequence of our
% uncertainty about the long-run frequency. You can't estimate which
% frequency is correct by sampling only a specific one. For this reason it
% isn't meaningful to focus on only one particular frequency at a time, as
% done there. What matters instead is the relative probabilities that the
% data have under several candidate frequencies. It's therefore unclear
% what's achieved by sampling multiple times 



%%\setlength{\intextsep}{0.5ex}% with wrapfigure
%\begin{figure}[p!]%{r}{0.4\linewidth} % with wrapfigure
%  \centering\includegraphics[trim={12ex 0 18ex 0},clip,width=\linewidth]{maxent_saddle.png}\\
%\caption{caption}\label{fig:comparison_a5}
%\end{figure}% exp_family_maxent.nb


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Acknowledgements
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
\begin{acknowledgements}
  PGLPM thanks Mari, Miri, \amp\ Emma for continuous encouragement and
  affection; Buster Keaton and Saitama for filling life with awe and
  inspiration; and the developers and maintainers of \LaTeX, Emacs, AUC\TeX,
  Open Science Framework, Python, Inkscape, Sci-Hub for making a free and
  unfiltered scientific exchange possible.
%\rotatebox{15}{P}\rotatebox{5}{I}\rotatebox{-10}{P}\rotatebox{10}{\reflectbox{P}}\rotatebox{-5}{O}.
\sourceatright{\autanet}
\end{acknowledgements}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Appendices
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%\clearpage
% %\renewcommand*{\appendixpagename}{Appendix}
% %\renewcommand*{\appendixname}{Appendix}
% %\appendixpage
% \appendix

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Bibliography
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
\defbibnote{prenote}{{\footnotesize (\enquote{de $X$} is listed under D,
    \enquote{van $X$} under V, and so on, regardless of national
    conventions.)\par}}
% \defbibnote{postnote}{\par\medskip\noindent{\footnotesize% Note:
%     \arxivp \mparcp \philscip \biorxivp}}

\printbibliography[prenote=prenote%,postnote=postnote
]

\end{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Cut text (won't be compiled)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 


%%% Local Variables: 
%%% mode: LaTeX
%%% TeX-PDF-mode: t
%%% TeX-master: t
%%% End: 
